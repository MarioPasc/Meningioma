# Meningioma/preprocessing/tools submodule

This submodule contains all the python tools that are being used in the preprocessing pipeline. Some tools may be external libraries located at Meningioma/external. The current files included in tools are:

1. `remove_extra_channles.py`. Includes a tool that reads a nrrd file path, and, if the volume contains more than one channel, then it removes the first channel, which mayb be realted to complex data or other echo times on T2 pulses. The function makes the necessary changes in the header orderedDict and returns the input volume as an `sitk.Image` object.
2. `nrrd_to_nifti.py`. This is a customized tools originally coded in [here](https://github.com/pnlbwh/conversion/blob/master/conversion/nifti_write.py) for DWT RM images. In the current implementation of this library, the tool is adapted to only work with sMRI images. Currently, the tools accepts the nrrd path as an input, or, a Tuple of `(sitk.Image, collections.OrderedDict)`, containing the volume and the header. The function translated the nrrd header to nifti header, and return the path to the `nii.gz` file.
3. `casting.py`. This file contains a simple casting functionality for the volume and mask. The volume is casted into a `float32` dtype, while the mask is casted to a `np.uint8` dtype. The minimum intensity of the mask is being set to zero, while the maximum intensity if being set to one.
4. `reorient.py`. Provides the functionality to standarize the orientation of the volumes and masks to a standard medical orientation formal. By default, it is set to LPS, the standard DICOM format. More information in [this link](https://theaisummer.com/medical-image-coordinates/#the-coordinate-systems-in-medical-imaging).
5. `resample.py`. Standarizes the pixel resolution to fit the real-coordinates desired voxel format. The default value is $1x1x1$ $mm^3$. The interpolator for the mask is fixed, and the interpolator used for the volume is `sitk.sitkBSpline` (for now). When the input volume has a lower voxel size then the desired, some segmentation masks and slices may be lost due to undersampling to fit the desired voxel size. However, when the adquisition voxel depth is higher than the desired voxel size, the interpolator is used to generate new images to fill the void between slices.
